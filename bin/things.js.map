{"version":3,"sources":["../lib/things.js"],"names":["FailedCertification","warn","FailedNotFound","InvalidValue","FailedToGetProduct","error","FailedToGetProduct401","EOL","FailedToGetProduct404","FailedToCreateTrial","FailedToCreateTrial400","FailedToCreateTrial401","FailedToCreateTrial403","Things","ErrorMessages","constructor","getProduct","deviceId","req","ThingsGetProductRequest","accessToken","FunctionsConfig","AccessToken","res","send","response","status","Promise","reject","ThingsError","data","createTrial","liff","name","ThingsCreateTrialRequest","detail"],"mappings":"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","sourcesContent":["import { EOL } from 'os';\nimport './colors-set-theme';\nimport { FunctionsConfig } from './functions-config';\nimport { ThingsCreateTrialRequest } from './things-create-trial-request';\nimport { ThingsError } from './things-error';\nimport { ThingsGetProductRequest } from './things-get-product-request';\n\nexport const FailedCertification = `Certification failed.`.warn;\nexport const FailedNotFound = `Either not found or you do not have access rights.`.warn;\nexport const InvalidValue = `The request contains an invalid value.`.warn;\n\nexport const FailedToGetProduct = `Failed to get product`.error;\nexport const FailedToGetProduct401 = FailedToGetProduct + EOL + FailedCertification;\nexport const FailedToGetProduct404 = FailedToGetProduct + EOL + FailedNotFound;\n\nexport const FailedToCreateTrial = `Failed to create trial product`.error;\nexport const FailedToCreateTrial400 = `Failed to create trial product`.error + EOL + InvalidValue;\nexport const FailedToCreateTrial401 = `Failed to create trial product`.error + EOL + FailedCertification;\nexport const FailedToCreateTrial403 = `Failed to create trial product`.error + EOL + `We have already reached the maximum number of trial products (maximum of 10). Delete unnecessary trial products.`.warn;\n\nexport class Things {\n\n    static get ErrorMessages() {\n        return {\n            FailedToGetProduct,\n            FailedToGetProduct401,\n            FailedToGetProduct404,\n            FailedToCreateTrial,\n            FailedToCreateTrial400,\n            FailedToCreateTrial401,\n            FailedToCreateTrial403\n        };\n    }\n\n    constructor() { }\n\n    /**\n     * \n     * @param {string} deviceId Device ID\n     */\n    async getProduct(deviceId) {\n        const req = new ThingsGetProductRequest({ accessToken: FunctionsConfig.AccessToken });\n        let res;\n\n        try {\n            res = await req.send(deviceId);\n        } catch (error) {\n            if (error.response.status === 401) {\n                return Promise.reject(new ThingsError(Things.ErrorMessages.FailedToGetProduct401));\n            } else if (error.response.status === 404) {\n                return Promise.reject(new ThingsError(Things.ErrorMessages.FailedToGetProduct404));\n            } else {\n                return Promise.reject(new ThingsError(Things.ErrorMessages.FailedToGetProduct));\n            }\n        }\n\n        return res.data;\n    }\n\n\n    /**\n     * \n     * @param {string} liff LIFF ID\n     * @param {string} name Product name\n     */\n    async createTrial(liff, name) {\n        const req = new ThingsCreateTrialRequest({ accessToken: FunctionsConfig.AccessToken });\n        let res;\n\n        try {\n            res = await req.send(liff, name);\n        } catch (error) {\n            if (error.response && error.response.data && error.response.data.detail) {\n                return Promise.reject(new ThingsError(Things.ErrorMessages.FailedToCreateTrial + EOL + error.response.data.detail.warn));\n            } else if (error.response.status === 400) {\n                return Promise.reject(new ThingsError(Things.ErrorMessages.FailedToCreateTrial400));\n            } else if (error.response.status === 401) {\n                return Promise.reject(new ThingsError(Things.ErrorMessages.FailedToCreateTrial401));\n            } else if (error.response.status === 403) {\n                return Promise.reject(new ThingsError(Things.ErrorMessages.FailedToCreateTrial403));\n            } else {\n                return Promise.reject(new ThingsError(Things.ErrorMessages.FailedToCreateTrial));\n            }\n        }\n\n        return res.data;\n    }\n\n}\n"],"file":"things.js"}